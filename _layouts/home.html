<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" href="{{ site.url }}/assets/favicon.ico?" type="image/x-icon" />
    <meta property="og:title" content="{{ site.title }}">
    <meta property="og:type" content="website">
    <meta property="og:description"
        content="CM-SS13 is a strategic roleplay-based team deathmatch game, based on Space Station 13.">
    <meta name="description"
        content="CM-SS13 is a strategic roleplay-based team deathmatch game, based on Space Station 13.">
    <meta property="og:image" content="{{ site.url }}/logo.png">
    <meta property="og:sitename" content="{{ site.url }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/90136e7f9b.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous" />
    <link href="{{ site.url }}/assets/stylesheet.css" rel="stylesheet">
    <title>CM-SS13 - Home</title>

    <script>
        fetch("https://db.cm-ss13.com/api/Round").then((value) => value.json().then((json) => {
            const display_element = document.getElementById("server_info");
            const gamestates = ["Startup", "Pre-game", "Setting up", "Playing", "Finished"];

            const formatDuration = (round_duration) => {
                const totalSeconds = Math.floor(round_duration / 10);
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                return `${hours}h ${minutes}m ${seconds}s`;
            };

            const renderServerCard = (server) => {
                if (server.status === "unavailable") {
                    return;
                }

                const data = server.data;
                const gamestate = gamestates[data.gamestate] || "Unknown";
                const duration = formatDuration(data.round_duration);

                return `
                    <div class="card bg-dark text-white border border-secondary">
                        <div class="card-header border-bottom border-secondary d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fa fa-server me-2"></i>${server.name}</h5>
                            <span class="fw-bold"><i class="fa fa-users me-1"></i>${data.players}</span>
                        </div>
                        <div class="card-body">
                            <div class="small d-flex flex-wrap gap-2">
                                <span>Round #${data.round_id}</span>
                                <span>${data.mode}</span>
                                <span>${data.map_name}</span>
                                <span>${duration}</span>
                                <span>${gamestate}</span>
                            </div>
                        </div>
                    </div>
                `;
            };

            display_element.innerHTML = json.servers.map(renderServerCard).join('');
        }))
    </script>
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>

    <!-- CRT Effect Overlay -->
    <div class="crt"></div>

    <div class="container-fluid">
        <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark border-bottom background-black">
            <div class="container-fluid">
                <a class="navbar-brand d-lg-none" href="{{ site.url }}">
                    <img src="{{ site.url }}/assets/logo.png" alt="Logo" height="40px" />
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="fa fa-bars"></i>
                </button>
                <div class="navbar-collapse collapse" id="navbarNav">
                    <div class="navbar-nav w-100 justify-content-evenly">
                        <a class="nav-item nav-link" href="{{ site.play_link }}"><i class="fa fa-gamepad"></i>Play Now</a>
                        <a class="nav-item nav-link" href="{{ site.rules_link }}"><i class="fa fa-bars"></i>Rules</a>
                        <a class="nav-item nav-link" href="{{ site.status_link }}"><i class="fa fa-server"></i>Status</a>
                        <a class="nav-item nav-link" href="{{ site.wiki_link }}"><i class="fa fa-book"></i>Wiki</a>
                        <a class="nav-item nav-link" href="{{ site.forums_link }}"><i class="fa-brands fa-discourse"></i>Forums</a>
                        <a class="nav-item nav-link" href="{{ site.discord_link }}"><i class="fa-brands fa-discord"></i>Discord</a>
                        <a class="nav-item nav-link" href="{{ site.github_link }}"><i class="fa-brands fa-github"></i>GitHub</a>
                    </div>
                </div>
            </div>
        </nav>

        <div class="container-fluid min-vh-100 d-flex flex-column justify-content-center align-items-center">
            <img src="{{ site.url }}/assets/logo.png" alt="Logo" width="250px" height="90px" class="d-none d-lg-block" />

            <div class="z-3 container-fluid bg-dark border-top background-black content-bezel">
                <div class="row mb-3">
                    <div class="col text-center">

                        <p>
                        <h1>What is CM-SS13?</h1>
                        CM-SS13 is a game based on Space Station 13, made in BYOND.
                        Check out our <a href="{{ site.wiki_link }}/Quickstart_Guide">Quickstart Guide</a> if you're new
                        to
                        CM.
                        </p>
                        <p>
                            CM-SS13 has wildly adapted the SS13 model into a strategic roleplay-based team deathmatch
                            game.
                        </p>
                        <div class="steam-widget mx-auto">
                            <iframe src="https://store.steampowered.com/widget/4313790/" frameborder="0"></iframe>
                        </div>
                    </div>
                    <div id="server_info" class="mt-3 d-flex flex-wrap justify-content-center gap-3"></div>
                </div>
                <div class="row">
                    <div class="col-12 col-md-4 text-center">
                        <h2><a href="{{ site.wiki_link }}"><i class="fa fa-book"></i>Wiki</a></h2>
                        <p>CM-SS13 is a very complex game, with a depth of features and complexity of interwoven systems
                            that can take a long time to get your head around. Our wiki contains guides, stats and all
                            information you need to get to grips with CM.</p>
                    </div>
                    <div class="col-12 col-md-4 text-center">
                        <h3><a href="{{ site.forums_link }}"><i class="fa-brands fa-discourse"></i>Forums</a></h3>
                        <p>Our forums are where we get most of our feedback, suggestions and wherever a longer-form
                            conversation needs to take place. It's also where we handle appeals, whitelists and reports.</p>
                        <h3><a href="{{ site.discord_link }}"><i class="fa-brands fa-discord"></i>Discord</a></h3>
                        <p>Our Discord is a more informal space, for discussion of the previous round, contributing to
                            the game, or just general chitchat.</p>
                    </div>
                    <div class="col-12 col-md-4 text-center">
                        <h2><a href="{{ site.github_link }}"><i class="fa-brands fa-github"></i>GitHub</a></h2>
                        <p>CM, as an extension of SS13, is an open source game, so anyone is able to contribute directly
                            to our game. Managed by our volunteer Maintainers, we accept Pull Requests of new content on our
                            GitHub.</p>
                        <p>If you're interested in getting started with contributing, check out our <a
                                href="{{ site.wiki_link }}/Guide_to_Git">Guide to Contributing</a>.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center fixed-bottom">
        <div class="text-center p-4">
            Source available on <a href="{{ site.source_link }}"><i class="fa-brands fa-github"></i>GitHub</a> |
            <a href="{{ site.url }}/tos">Terms of Service</a>
        </div>
    </footer>

</body>

</html>